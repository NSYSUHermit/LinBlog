blogdown:::new_post_addin()
blogdown:::new_post_addin()
## 讀取資料
這次僅使用測試資料做validation
## 建立初始化神經網路
引入models以及layers，並設定Activation Function使用Rectified Linear Unit
blogdown:::serve_site()
blogdown:::new_post_addin()
library(shiny)
runExample("01_hello")
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
●Cost-sensitive Classification：將一般機器學習的損失函數 (loss function) 改為成本導向的損失函數。舉個常見的AdaCost演算法，先回憶Adaboost演算法是通過反覆迭代，每一輪迭代學習到一個分類器，並根據當前分類器的表現更新樣本的權重其更新策略為正確分類樣本權重降低，錯誤分類樣本權重加大，最終的模型是多次迭代模型的一個加權線性組合，分類越準確的分類器將會獲得越大的權重。
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::insert_image_addin()
![](/post/2019-10-02-one-class-learning_files/3.GIF)
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::insert_image_addin()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::insert_image_addin()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::insert_image_addin()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::insert_image_addin()
![](/post/2019-11-14-gan-with-one-class-learning_files/1.jpg)
我們將想要生成的某類資料匯入後，先建構一個一元分類器，並將所有資料點都包含於正常資料。接著將原資料匯入GAN當中，經過幾次迭代後，我們將GAN產生的偽資料匯入當初建立好的一元分類器當中，並檢查是否所有的偽資料皆能不被辨識為異常點，若是確認這批資料皆為正常點後(也就是成功欺騙一元分類器)
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::insert_image_addin()
結果上來看，以GAN平衡的結果較好，但仍存在一些問題。
第一：隨機森林參數並無調整，因此在這個差距上來看並不能說平衡後的模型較佳；
第二：在未平衡前資料分類就可達到相當水準，因此可見此份資料的分類並不需要平衡資料來達成
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::insert_image_addin()
---
title: GAN Sampling Versus Other Sampling Method On Credit Card Fraud Detection Data
author: Hermit
date: '2019-11-19'
slug: gan-sampling-versus-other-sampling-method-on-credit-card-fraud-detection-data
categories:
- gan
- machine-learning
- deep-learning
- Python
tags:
- classification
- neural network
---
This time I will use a imbalanced data from kaggle(link:https://www.kaggle.com/mlg-ulb/creditcardfraud/version/1).
![](/post/2019-11-19-gan-sampling-versus-other-sampling-method-on-credit-card-fraud-detection-data_files/1.jpg)
The datasets contains transactions made by credit cards in September 2013 by european cardholders. These transactions are a subset of all online transactions that occurred in two days, where we have 492 frauds out of 284,807 transactions. The dataset is highly unbalanced, where the positive class (frauds) account for 0.172% of all transactions. It contains only numerical input variables which are the result of a PCA transformation. Unfortunately, due to confidentiality issues, we cannot provide the original features and more background information about the data. Features V1, V2, ... V28 are the principal components obtained with PCA, the only features which have not been transformed with PCA are 'Time' and 'Amount'. Feature 'Time' contains the seconds elapsed between each transaction and the first transaction in the dataset. The feature 'Amount' is the transaction Amount, this feature can be used for example-dependant cost-senstive learning. Feature 'Class' is the response variable and it takes value 1 in case of fraud and 0 otherwise.
# Data Visualization
result <- data.frame(
x = letters[1:6],
y = rnorm(6),
z = runif(6) > 0.5
)
View(result)
result <- data.frame(
Non_Sampling = array[,],
Under_Sampling = array[,],
SMOTE = array[0.999557596696722,0.9003572630796582],
ADASYN = array[0.999557596696722,0.9003572630796582],
GAN = array[0.999557596696722,0.9003572630796582]
)
result <- data.frame(
Non_Sampling = array[0.9994803480263759,0.8678545237199384],
Under_Sampling = array[0.9995084373222475,0.8901876266312907],
SMOTE = array[0.9994663033784401,0.9023405417267101],
ADASYN = array[0.9993890578147933,0.8982438459344533],
GAN = array[0.999557596696722,0.9003572630796582]
)
result <- data.frame(
Non_Sampling = list[0.9994803480263759,0.8678545237199384],
Under_Sampling = list[0.9995084373222475,0.8901876266312907],
SMOTE = list[0.9994663033784401,0.9023405417267101],
ADASYN = list[0.9993890578147933,0.8982438459344533],
GAN = list[0.999557596696722,0.9003572630796582]
)
result <- data.frame(
Non_Sampling = list(0.9994803480263759,0.8678545237199384),
Under_Sampling = list(0.9995084373222475,0.8901876266312907),
SMOTE = list(0.9994663033784401,0.9023405417267101),
ADASYN = list(0.9993890578147933,0.8982438459344533),
GAN = list(0.999557596696722,0.9003572630796582)
)
View(result)
View(result)
result <- data.frame(
Non_Sampling = array(0.9994803480263759,0.8678545237199384),
Under_Sampling = array(0.9995084373222475,0.8901876266312907),
SMOTE = array(0.9994663033784401,0.9023405417267101),
ADASYN = array(0.9993890578147933,0.8982438459344533),
GAN = array(0.999557596696722,0.9003572630796582)
)
View(result)
GAN = array(0.999557596696722,0.9003572630796582)
GAN = vector(0.999557596696722,0.9003572630796582)
GAN = dataframe(0.999557596696722,0.9003572630796582)
GAN = data.frame(0.999557596696722,0.9003572630796582)
View(GAN)
result <- data.frame(
Non_Sampling = data.frame(0.9994803480263759,0.8678545237199384),
Under_Sampling = data.frame(0.9995084373222475,0.8901876266312907),
SMOTE = data.frame(0.9994663033784401,0.9023405417267101),
ADASYN = data.frame(0.9993890578147933,0.8982438459344533),
GAN = data.frame(0.999557596696722,0.9003572630796582)
)
View(result)
View(GAN)
View(result)
View(GAN)
result <- data.frame()
result$
View(GAN)
View(result)
result$Non_Sampling = data.frame(0.9994803480263759,0.8678545237199384)
result$Non_Sampling = vector(0.9994803480263759,0.8678545237199384)
result$Non_Sampling = float(0.9994803480263759,0.8678545237199384)
result$Non_Sampling = double(0.9994803480263759,0.8678545237199384)
result$Non_Sampling = [0.9994803480263759,0.8678545237199384]
result$Non_Sampling = c(0.9994803480263759,0.8678545237199384)
result$Non_Sampling = vector(c(0.9994803480263759,0.8678545237199384))
result$Non_Sampling = data.frame(c(0.9994803480263759,0.8678545237199384))
result = data.frame(c(0.9994803480263759,0.8678545237199384))
View(result)
result$Under_Sampling = data.frame(c(0.9995084373222475,0.8901876266312907))
View(result)
View(result)
result$SMOTE = data.frame(0.9994663033784401,0.9023405417267101)
result$ADASYN = data.frame(c(0.9993890578147933,0.8982438459344533))
result$GAN = data.frame(c(0.999557596696722,0.9003572630796582))
View(result)
result <- data.frame()
result <- data.frame()
result = data.frame(c(0.9994803480263759,0.8678545237199384))
result$Under_Sampling = data.frame(c(0.9995084373222475,0.8901876266312907))
result$SMOTE = data.frame(c(0.9994663033784401,0.9023405417267101))
result$ADASYN = data.frame(c(0.9993890578147933,0.8982438459344533))
result$GAN = data.frame(c(0.999557596696722,0.9003572630796582))
View(result)
colnames(result) <- c("Non Sampling","Under Sampling","SMOTE","ADASYN","GAN")
View(result)
colnames(result)
result <- data.frame()
colnames(result) <- c("Non Sampling","Under Sampling","SMOTE","ADASYN","GAN")
result <- data.frame()
result = data.frame(c(0.9994803480263759,0.8678545237199384))
result$Under_Sampling = data.frame(c(0.9995084373222475,0.8901876266312907))
result$SMOTE = data.frame(c(0.9994663033784401,0.9023405417267101))
result$ADASYN = data.frame(c(0.9993890578147933,0.8982438459344533))
result$GAN = data.frame(c(0.999557596696722,0.9003572630796582))
colnames(result) <- c("Non Sampling","Under Sampling","SMOTE","ADASYN","GAN")
View(result)
result <- data.frame()
result = data.frame(c(0.9994803480263759,0.8678545237199384))
result$Under_Sampling = data.frame(c(0.9995084373222475,0.8901876266312907))
result$SMOTE = data.frame(c(0.9994663033784401,0.9023405417267101))
result$ADASYN = data.frame(c(0.9993890578147933,0.8982438459344533))
result$GAN = data.frame(c(0.999557596696722,0.9003572630796582))
colnames(result) <- c("Non Sampling","Under Sampling","SMOTE","ADASYN","GAN")
rownames(result) <- c("ACC","AUC")
View(result)
result <- data.frame()
result = data.frame(c(0.9994803480263759,0.8678545237199384))
result$Under_Sampling = data.frame(c(0.9995084373222475,0.8901876266312907))
result$SMOTE = data.frame(c(0.9994663033784401,0.9023405417267101))
result$ADASYN = data.frame(c(0.9993890578147933,0.8982438459344533))
result$GAN = data.frame(c(0.999557596696722,0.9003572630796582))
result$index <- c("ACC","AUC")
colnames(result) <- c("Non Sampling","Under Sampling","SMOTE","ADASYN","GAN")
rownames(result) <- c("ACC","AUC")
View(result)
result <- data.frame()
result = data.frame(c(0.9994803480263759,0.8678545237199384))
result$Under_Sampling = data.frame(c(0.9995084373222475,0.8901876266312907))
result$SMOTE = data.frame(c(0.9994663033784401,0.9023405417267101))
result$ADASYN = data.frame(c(0.9993890578147933,0.8982438459344533))
result$GAN = data.frame(c(0.999557596696722,0.9003572630796582))
result$index <- c("ACC","AUC")
colnames(result) <- c("Non Sampling","Under Sampling","SMOTE","ADASYN","GAN","index")
rownames(result) <- c("ACC","AUC")
View(result)
library(tideverse)
library(tidyverse)
ggplot(data = result,mapping = aes(x = index))
result  = data.frame(t(result))
View(result)
result <- data.frame()
result = data.frame(c(0.9994803480263759,0.8678545237199384))
result$Under_Sampling = data.frame(c(0.9995084373222475,0.8901876266312907))
result$SMOTE = data.frame(c(0.9994663033784401,0.9023405417267101))
result$ADASYN = data.frame(c(0.9993890578147933,0.8982438459344533))
result$GAN = data.frame(c(0.999557596696722,0.9003572630796582))
colnames(result) <- c("Non Sampling","Under Sampling","SMOTE","ADASYN","GAN","index")
result <- data.frame()
result = data.frame(c(0.9994803480263759,0.8678545237199384))
result$Under_Sampling = data.frame(c(0.9995084373222475,0.8901876266312907))
result$SMOTE = data.frame(c(0.9994663033784401,0.9023405417267101))
result$ADASYN = data.frame(c(0.9993890578147933,0.8982438459344533))
result$GAN = data.frame(c(0.999557596696722,0.9003572630796582))
colnames(result) <- c("Non Sampling","Under Sampling","SMOTE","ADASYN","GAN")
rownames(result) <- c("ACC","AUC")
#result$index <- c("ACC","AUC")
result  = data.frame(t(result))
View(result)
View(result)
ggplot(data = result,mapping = aes(x = ACC)
ggplot(data = result,mapping = aes(x = ACC))
ggplot(data = result,mapping = aes(x = ACC))+
geom_freqploy(binwidth = 0.1)
library(ggplot2)
ggplot(data = result,mapping = aes(x = ACC))+
geom_freqploy(binwidth = 0.1)
library(ggplot2)
ggplot(data = result,mapping = aes(x = ACC))+
geom_freqpoly(binwidth = 0.1)
library(ggplot2)
ggplot(data = result,mapping = aes(x = ACC))+
geom_freqpoly()
library(ggplot2)
ggplot(data = result,mapping = aes(x = ACC,y = AUC))+
geom_freqpoly()
library(ggplot2)
ggplot(data = result)+
geom_fpoint(mapping = aes(x = ACC,y = AUC))
library(ggplot2)
ggplot(data = result)+
geom_point(mapping = aes(x = ACC,y = AUC))
ggplot(data = result)+
geom_point(mapping = aes(x = ACC,y = AUC,color = rownames))
ggplot(data = result)+
geom_point(mapping = aes(x = ACC,y = AUC,color = rownames(result)))
ggplot(data = result)+
geom_point(mapping = aes(x = ACC,y = AUC,color = rownames(result),shape=17))
library(ggplot2)
ggplot(data = result)+
geom_point(mapping = aes(x = ACC,y = AUC,color = rownames(result)),shape=17)
library(ggplot2)
ggplot(data = result)+
geom_point(mapping = aes(x = ACC,y = AUC,color = rownames(result)),size=17)
library(ggplot2)
ggplot(data = result)+
geom_point(mapping = aes(x = ACC,y = AUC,color = rownames(result)),size=7)
result <- data.frame()
result = data.frame(c(0.9994803480263759,0.8678545237199384))
result$Under_Sampling = data.frame(c(0.9995084373222475,0.8901876266312907))
result$SMOTE = data.frame(c(0.9994663033784401,0.9023405417267101))
result$ADASYN = data.frame(c(0.9993890578147933,0.8982438459344533))
result$GAN = data.frame(c(0.999557596696722,0.9003572630796582))
colnames(result) <- c("Non Sampling","Under Sampling","SMOTE","ADASYN","GAN")
rownames(result) <- c("ACC","AUC")
#result$index <- c("ACC","AUC")
result  = data.frame(t(result))
result
library(ggplot2)
ggplot(data = result)+
geom_point(mapping = aes(x = ACC,y = AUC,color = rownames(result)),size=7)
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::insert_image_addin()
![](/post/2019-11-25-gan-based-small-sample-augmentation_files/1.jfif)
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::insert_image_addin()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::insert_image_addin()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::insert_image_addin()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::insert_image_addin()
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)
# Read data
data_csv <- read.csv("20191202_1471_CRE_46-non-CRE_49_Intensity.csv")
# arrange
if (!require(tidyverse)) install.packages('tidyverse')
library(tidyverse)
#sort data by p.value
data_csv <- arrange(data_csv,p.value)
#transpose data
name_protein <- data_csv[,1]
data <- as.data.frame(t(data_csv))
data <- data[-c(1:3),]
#data name
name_variable <- names(data)
data_name <- data.frame(name_variable,name_protein)
data_name <- as.data.frame(t(data_name))
#label CRE as factor
data$CRE <- as.factor(c(rep(1,46),rep(0,49)))
df1 = data
#classification function
pca.clf <- function(lgr = TRUE,nb = TRUE,knn = TRUE,rf = TRUE,svm = TRUE,pca_num){
#filter pca num
df = as.data.frame(df1[,c(1:pca_num)])
names(df) = names(df1[c(1:pca_num)])
df$CRE = df1$CRE
#ml model training
library(caret)
#svm
if(svm){
if (!require(e1071))install.packages('e1071')
library(e1071)
test.pred <- vector()
for(i in c(1:dim(df)[1])){
train = df[-i, ]
test  = df[i, ]
#pca processing
pca <- prcomp(~.-CRE, data=train)
train_pca <- as.data.frame(pca$x)
train_pca$CRE <- train$CRE
#Matrix multiplication
test_pca = as.data.frame(as.matrix(test[,-dim(test)[2]])%*%as.matrix(pca$rotation))
test_pca$CRE <- test$CRE
svm_model = svm(formula = CRE ~ .,data = train_pca)
test.pred[i] = as.integer(predict(svm_model, test_pca))-1
}
#result present
confus.matrix = table(test.pred,df$CRE)
if(dim(confus.matrix)[1] > 1){
num11 <- confus.matrix[2,2]
num00 <- confus.matrix[1,1]
}else{
num11 = confus.matrix[1,2]
num00 = 0
}
svm <- c("SupportVectorMachine",num11+num00,(num11+num00)/sum(confus.matrix),num11,as.integer(num00),num11/sum(confus.matrix[,2]),num00/sum(confus.matrix[,1]))
}
#rf
if(rf){
if (!require(randomForest)) install.packages('randomForest')
library(randomForest)
test.pred <- vector()
for(i in c(1:dim(df)[1])){
train = df[-i, ]
test  = df[i, ]
#pca processing
pca <- prcomp(~.-CRE, data=train)
train_pca <- as.data.frame(pca$x)
train_pca$CRE <- train$CRE
#Matrix multiplication
test_pca = as.data.frame(as.matrix(test[,-dim(test)[2]])%*%as.matrix(pca$rotation))
test_pca$CRE <- test$CRE
rf_model = randomForest(CRE~.,data=train_pca,ntree=150# num of decision Tree
)
test.pred[i] = as.integer(predict(rf_model, test_pca))-1
}
#result present
confus.matrix = table(test.pred,df$CRE)
if(dim(confus.matrix)[1] > 1){
num11 <- confus.matrix[2,2]
num00 <- confus.matrix[1,1]
}else{
num11 = confus.matrix[1,2]
num00 = 0
}
rf <- c("RandomForest",num11+num00,(num11+num00)/sum(confus.matrix),num11,as.integer(num00),num11/sum(confus.matrix[,2]),num00/sum(confus.matrix[,1]))
}
# knn
if(knn){
if (!require(class))install.packages("class")
library(class)
test.pred <- vector()
for(i in c(1:dim(df)[1])){
train = df[-i, ]
test  = df[i, ]
#pca processing
pca <- prcomp(~.-CRE, data=train)
train_pca <- as.data.frame(pca$x)
train_pca$CRE <- train$CRE
#Matrix multiplication
test_pca = as.data.frame(as.matrix(test[,-dim(test)[2]])%*%as.matrix(pca$rotation))
test_pca$CRE <- test$CRE
#pred
test.pred[i] <- knn(train = train_pca[,-length(train_pca)], test = test_pca[,-length(test_pca)], cl = train_pca[,length(train_pca)], k = 5)   # knn distance = 5
}
#result present
confus.matrix = table(test.pred,df$CRE)
if(dim(confus.matrix)[1] > 1){
num11 <- confus.matrix[2,2]
num00 <- confus.matrix[1,1]
}else{
num11 = confus.matrix[1,2]
num00 = 0
}
knn <- c("NearestNeighbors",num11+num00,(num11+num00)/sum(confus.matrix),num11,as.integer(num00),num11/sum(confus.matrix[,2]),num00/sum(confus.matrix[,1]))
}
# nb
if(nb){
test.pred <- vector()
for(i in c(1:dim(df)[1])){
train = df[-i, ]
test  = df[i, ]
#pca processing
pca <- prcomp(~.-CRE, data=train)
train_pca <- as.data.frame(pca$x)
train_pca$CRE <- train$CRE
#Matrix multiplication
test_pca = as.data.frame(as.matrix(test[,-dim(test)[2]])%*%as.matrix(pca$rotation))
test_pca$CRE <- test$CRE
#pred
nb_model=naiveBayes(CRE~., data=train_pca)
test.pred[i] = as.integer(predict(nb_model, test_pca))-1
}
#result present
confus.matrix = table(test.pred,df$CRE)
if(dim(confus.matrix)[1] > 1){
num11 <- confus.matrix[2,2]
num00 <- confus.matrix[1,1]
}else{
num11 = confus.matrix[1,2]
num00 = 0
}
nb <- c("NavieBayes",num11+num00,(num11+num00)/sum(confus.matrix),num11,as.integer(num00),num11/sum(confus.matrix[,2]),num00/sum(confus.matrix[,1]))
}
#lgr
if(lgr){
test.pred <- vector()
df$CRE = as.numeric(df$CRE)-1
#pca processing
pca <- prcomp(~.-CRE, data=train)
train_pca <- as.data.frame(pca$x)
train_pca$CRE <- train$CRE
#Matrix multiplication
test_pca = as.data.frame(as.matrix(test[,-dim(test)[2]])%*%as.matrix(pca$rotation))
test_pca$CRE <- test$CRE
#pred
for(i in c(1:dim(df)[1])){
train = df[-i, ]
test  = df[i, ]
lr_model<-glm(formula=CRE~.,data=train,family=binomial)
test.pred[i] <- ifelse(predict(lr_model, test,type = "response") > 0.5, 1, 0)
}
#result present
confus.matrix = table(test.pred,df$CRE)
if(dim(confus.matrix)[1] > 1){
num11 <- confus.matrix[2,2]
num00 <- confus.matrix[1,1]
}else{
num11 = confus.matrix[1,2]
num00 = 0
}
lgr <- c("LogisticRegression",num11+num00,(num11+num00)/sum(confus.matrix),num11,as.integer(num00),num11/sum(confus.matrix[,2]),num00/sum(confus.matrix[,1]))
}
#return results
result <- c(46,49,pca_num,lgr,nb,knn,rf,svm)
return(result)
}
a = as.data.frame(t(pca.clf(pca=1)))
for(i in c(2:25)){
b = as.data.frame(t(pca.clf(pca=i)))
a = rbind(a,b)
}
View(a)
names(a) = c("num_cre","num_non","num_pca","method","right_pred_num","acc","right_pred_cre_num","right_pred_ncre_num","right_pred_cre_acc","right_pred_ncre_acc","method","right_pred_num","acc","right_pred_cre_num","right_pred_ncre_num","right_pred_cre_acc","right_pred_ncre_acc","method","right_pred_num","acc","right_pred_cre_num","right_pred_ncre_num","right_pred_cre_acc","right_pred_ncre_acc","method","right_pred_num","acc","right_pred_cre_num","right_pred_ncre_num","right_pred_cre_acc","right_pred_ncre_acc","method","right_pred_num","acc","right_pred_cre_num","right_pred_ncre_num","right_pred_cre_acc","right_pred_ncre_acc")
write.csv(a,file = "pca_result.csv",row.names = FALSE)
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::insert_image_addin()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::insert_image_addin()
blogdown:::serve_site()
